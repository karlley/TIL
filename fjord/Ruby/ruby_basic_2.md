# ruby_basic_2

プロを目指す人のためのRuby入門

# チェリー本の読み方

* 6章までは手続き型のプログラム(lsコマンドあたりまで)
* 7章からがオブジェクト指向(Rails あたりから必要)
* 写経は例題だけでok、気になったところのみをirb で動かす
* フィヨルドのオブジェクト指向プログラミング、Rails になったら7章を再読
* 1h * 7日 1週間を目安に読破

# まとめ

* 1 - 6章
  * 全部必要
  * 手を動かすのは例題だけでok
* 7章
  * 7-8 まで必須
  * 7-9 以降はだいたいでok
* 8章
  * 8-4 まで必須
  * 8-5 以降はだいたいでok
* 9章
  * 9-5 まで必須(最悪読まなくてもフィヨルドは大丈夫)
* 10章
  * 10-4 まで8割
  * 例題をやると理解できるかも
* 11章 全部必須
* 12章 全部必須
* 付録 目を通す

## Minitest

* テストのクラス名は`Test` で終わる/始まる形で命名する事が多い
* テストコードのファイル名は`テストクラス名_test.rb` のようにクラス名と合わせる
* メソッド名を`test_` で始めることでテストを読み込む

## 正規表現

* `\d`: 1つの半角数字(digit)
* `\w`: 半角英数字、アンダーバー
* `{n,m}`: 直前の文字が`n` 個以上、`m` 個以下、`,`の後ろにスペースは入れない
* `{n,}`: 直前の文字が`n`個以上
* `{,n}`: 直前の文字が`n`個以下
* `[AB]`: A or B の1文字
* `[a-z]`: a からzまでのいずれかの一文字、[]の中で最初/最後を除く場合は範囲指定を表す
* `~?`: ~が1文字 or 無し
* `.`: 任意の1文字
* `+`: 直前の文字が1文字以上
* `*`: 直前の文字が0文字以上
* `\`: エスケープ文字
* `()`: キャプチャ(マッチした部分を抜き出す)
* `(ABC)?`: 文字列ABC or 無し 
* `(?: ABC)`: 文字列ABCをキャプチャから除外する
* `[^A]`: A以外の1文字
* `[^AB]`: AとB以外の1文字
* `*?`,`+?`: 最短のマッチを返す
* `^`: 行頭、アンカー
* `$`: 行末、アンカー
* `\b`: 単語の境界(boundary)、アンカー
* `\t`: タブ
* `\s`: 空白文字全般(言語によって含まれる文字が異なる)
* `\n`: 改行(Windows は`\r\n\`)
* `\r`: 復帰文字
* `\f`: 改ページ文字
* `A|B`、`(A|B)`: A or B
* `\W`: 半角英数字、アンダーバー以外
* `\D`: 半角数字以外
* `\S`: 空白文字以外
* `\B`: 単語の境界以外

### * と+ は貪欲である

> パターンの結果として矛盾がなければ、（貪欲に）最長のマッチを結果として返すのです。

期待する値への対策

* 条件を厳しくする(`^`を使ってマッチする範囲を狭める)
* 最短のマッチを返すように指定(`*?`、`+?`を使って最短のマッチに修正する)

### 後読み/先読み

* `(?<=abc)`: abcの直後の位置にマッチ(後読み)
* `(?=abc)`: abcの直前の位置にマッチ(先読み)
* JavaScript やエディタでは後読みが使えない場合がある
* `(?<!abc)`: abc以外の直後の位置にマッチ(否定の後読み)
* `(?!abc)`: abc以外の直前の位置にマッチ(否定の先読み)

### 後方参照

`( )` でキャプチャされた文字列を`\1`で参照する

```
<a href="(.+?)">\1<\/a>
```

`(.+?)` と`\1` は同じ文字列を指す

### パフォーマンス

バックトラックという動作原理が原因で書き方によっては動作に負荷がかかる

* `+`や`*`が`()`の中と外に出てくる正規表現は危険
* 危険そう感じたらオンラインツールで動作を確認する
