# ls_command

# 数値の除算の小数点以下の切り上げ

除算の小数点以下を切り上げしたい

```
# 目標
13 / 3
#=> 5 # 計算結果は4.3333..

7 / 3
#=> 3 # 2.3333..
```

Ruby の仕様

```
# 除算の結果は小数点以下は切り捨てで整数化される
13 / 3
#=> 4
```

`to_f` で浮動小数点数にして`ceil` で小数点以下を繰り上げて整数化する

```
# ceil を使っても小数点以下は切り上げにならない
13 / 3.ceil
#=> 4 

# これだと上手くいかない
13 / 3.to_f.ceil
#=> 4

# （）で除算の結果の浮動小数点数に対してceil を行う
(13 / 3.to_f).ceil
#=> 5
```

[ruby 数値の四捨五入、切り捨て、切り上げ \- プログラミングで遊ぶ！](https://koooza.net/post-535)

# マジックナンバー

コードを書いた本人しか意味が分からない数値

参照: [【Ruby】 timesメソッドで指定した回数の処理を繰り返す方法とは？ \| Pikawaka](https://pikawaka.com/ruby/times)
参照: [テスト駆動開発から始めるRuby入門 ~2時間でTDDとリファクタリングのエッセンスを体験する~ \| １つの価値３つの領域 思想と技術](https://k2works.github.io/2020/04/16/1587009564/#%E3%83%9E%E3%82%B8%E3%83%83%E3%82%AF%E3%83%8A%E3%83%B3%E3%83%90%E3%83%BC)

* 自分以外がコードを読む際に負荷が掛かる
* 数値を定数化して意味が伝わるようにする

# 定数のポイント

* 途中で変更しない値を定数で定義する
* Ruby の定数は再代入可能
* 再代入をさせたくない場合は`freez` を使う
* メソッド内では定数は定義できない(`dynamic constant assignment` エラーが発生する)

# 変数の命名について

参照: [《変数名やメソッド名の付け方について》 \| FJORD BOOT CAMP（フィヨルドブートキャンプ）](https://bootcamp.fjord.jp/questions/1138)

* 書くのが楽 < 可読性
* 変数名を強引に略すのではなく、無駄な単語を省き意味の伝わる単語のみ連結する
* 変数名に悩んだ時はPRや提出物に「この変数名が自分でもイマイチな気がしてます」的なコメントを残し意見をもらう
* 言語によって命名の文化が異なる
* コンピューターではなく人間とのコミュニケーションの手段ということを意識した命名にする
* 公式ドキュメント、ライブラリ等を参考にして命名の感覚を鍛える

# 制御構造

## next

* ループ中に処理をスキップして次のループを行う
* `next if 条件` のように1行でもok

## break

* ループ中に処理を中断してループを抜ける
* 抜けるループは一番内側のループのみ
* `break if 条件` のように1行でもok

## redo

* ループ中に処理を中断してループをやり直す
* あまり使われない

## unless

* 条件式が偽の時に処理を実行する
* if の反対

# ガード節

* 処理の対象外とする条件をループの先頭に集めて`next`、`return` 等で抜ける方法
* 分岐の対象外の条件が先頭で分かるので深いネストを解消できる
* rubocop ではループ内の`if ~ end` はガード節を使った記述に自動修正される

参照: [Rubyのelsifとガード節どちらを使うか \- Qiita](https://qiita.com/mom0tomo/items/779b6e380dc01d3bda54)
参照: [rubocop様に"Use next to skip iteration\."のご指導を頂いたら。。。 \- Qiita](https://qiita.com/Apuruny/items/329494245b83527ba7ed)

## next、break、return の違い

ループ中の動作の違い

* `next`: 次のループを開始
* `break`: ループを抜ける
* `return`: メソッドを抜ける

参照: [【Ruby】next、break、returnのちがい｜Rubinistを目指す新米エンジニアのTECH BLOG](https://sakaishun.com/2021/04/20/next-break-return/)

## next の返り値を指定する

`map` でのループ時に条件に一致しない場合、`next` は`nil` を返すが、引数を渡す事で`nil` 以外を返すことができる

参照: [Rubyのmapで条件分岐をした時にnilが返ってきてしまう時の対処法 – 地方でリモートワーク](https://www.tom08.net/2016-09-26-003031/)

```
# next に引数を渡さない
array = [1, 2, 3]
result = array.map do |a|
next if a == 2
  a * 2
end
puts result
#=> [2, nil, 6]

# next に引数を渡す
array = [1, 2, 3]
result = array.map do |a|
next a if a == 2 # next に引数で元の値a を渡す
  a * 2
end
puts result
#=> [2, 2, 6]
```

## 範囲オブジェクトの範囲指定

以下、未満等の指定方法

* 以下: `..`
* 未満: `...`

```
# 範囲以下
> (1..5).each do |r|
  print r
end
#=>12345

# 範囲未満
> (1...5).each do |r|
  print r
end
#=> 1234
```


